<!DOCTYPE html>
<html>
<head>
    <title>ACTA-UI Production API Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
        .info { color: blue; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background: #0056b3; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üß™ ACTA-UI Production API Test</h1>
    
    <div class="section">
        <h2>Test Instructions</h2>
        <ol>
            <li>Open this page in production: <a href="https://d7t9x3j66yd8k.cloudfront.net" target="_blank">https://d7t9x3j66yd8k.cloudfront.net</a></li>
            <li>Log in with your credentials:
                <ul>
                    <li>Email: valencia942003@gmail.com</li>
                    <li>Password: [your password]</li>
                </ul>
            </li>
            <li>Open browser Developer Tools (F12)</li>
            <li>Run the test scripts below in the console</li>
        </ol>
    </div>

    <div class="section">
        <h2>üîß Production API Test Script</h2>
        <p>Copy and paste this into the browser console after logging in:</p>
        <pre id="testScript">
// ACTA-UI Production API Test
const BASE_URL = 'https://q2b9avfwv5.execute-api.us-east-2.amazonaws.com/prod';

async function testProductionAPI() {
    console.log('üß™ Testing ACTA-UI Production API');
    console.log('==================================');
    
    // Test health endpoint
    console.log('1. Testing health endpoint...');
    try {
        const response = await fetch(`${BASE_URL}/health`);
        console.log('‚úÖ Health:', response.status, await response.text());
    } catch (error) {
        console.error('‚ùå Health test failed:', error);
    }
    
    // Test protected endpoints (should get auth token automatically)
    console.log('\n2. Testing protected endpoints...');
    
    const endpoints = [
        '/projects',
        '/pm-manager/all-projects', 
        '/pm-manager/valencia942003@gmail.com',
        '/document-validator/test-project'
    ];
    
    for (const endpoint of endpoints) {
        try {
            const response = await fetch(`${BASE_URL}${endpoint}`, {
                headers: {
                    'Authorization': `Bearer ${await getAuthToken()}`
                }
            });
            
            const status = response.status;
            const statusText = response.statusText;
            
            if (status === 200) {
                console.log(`‚úÖ ${endpoint}: ${status} - Working!`);
            } else if (status === 403) {
                console.log(`üîê ${endpoint}: ${status} - Needs authentication (expected)`);
            } else if (status === 404) {
                console.log(`‚ùå ${endpoint}: ${status} - Endpoint missing`);
            } else {
                console.log(`‚ö†Ô∏è ${endpoint}: ${status} ${statusText}`);
            }
        } catch (error) {
            console.error(`‚ùå ${endpoint}: Network error`, error);
        }
    }
    
    console.log('\nüìä Test Summary:');
    console.log('- ‚úÖ = Endpoint working correctly');
    console.log('- üîê = Endpoint secured (needs auth token)');
    console.log('- ‚ùå = Endpoint not found or broken');
    console.log('- ‚ö†Ô∏è = Unexpected response');
}

// Helper function to get auth token
async function getAuthToken() {
    try {
        // Try to get token from Amplify
        const { fetchAuthSession } = await import('aws-amplify/auth');
        const session = await fetchAuthSession();
        return session.tokens?.idToken?.toString() || 'NO_TOKEN';
    } catch (error) {
        console.warn('Could not get auth token:', error);
        return 'NO_TOKEN';
    }
}

// Run the test
testProductionAPI();
        </pre>
        <button onclick="copyToClipboard('testScript')">üìã Copy Test Script</button>
    </div>
    
    <div class="section">
        <h2>üéØ Expected Results</h2>
        <div class="success">‚úÖ If endpoints return 200 or 403: API is working correctly</div>
        <div class="error">‚ùå If endpoints return 404: API endpoints missing - need deployment</div>
        <div class="warning">‚ö†Ô∏è If endpoints return 502: Lambda function errors - need debugging</div>
        <div class="info">‚ÑπÔ∏è If network errors: CORS or connectivity issues</div>
    </div>

    <div class="section">
        <h2>üîç Frontend Dashboard Test</h2>
        <p>After running the API test, try these actions in the dashboard:</p>
        <ol>
            <li>Click "Admin Dashboard" (if available)</li>
            <li>Try to load project lists</li>
            <li>Check for any error messages</li>
            <li>Try generating a document for a test project</li>
        </ol>
        <p>Expected behavior:</p>
        <ul>
            <li>Admin dashboard should show projects (if backend is working)</li>
            <li>Project generation should work for individual projects</li>
            <li>Error messages should be informative, not generic</li>
        </ul>
    </div>

    <div class="section">
        <h2>üìã Report Results</h2>
        <p>After testing, report back with:</p>
        <ol>
            <li>Console output from the test script</li>
            <li>Any error messages in the dashboard</li>
            <li>Whether admin dashboard loads projects</li>
            <li>Whether individual project generation works</li>
        </ol>
    </div>

    <script>
        function copyToClipboard(elementId) {
            const text = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('Test script copied to clipboard!');
            });
        }
    </script>
</body>
</html>
